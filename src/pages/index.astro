---
import { getCollection } from "astro:content";
import { WritingItem } from "@components/cards";
import { Header } from "@components/misc";
import { BaseHead } from "@components/seo";
import { SITE_DESCRIPTION, SITE_TITLE, socialLinks } from "@data/index";
import RootLayout from "@layouts/root-layout.astro";
import { clsx } from "@utils/index";

const whoami = await getCollection("whoami");
const whoamiData = whoami[0].data; // Get the first item from the collection
const { description } = whoamiData;
const { Content } = await whoami[0].render();

// Get the 3 most recent writings
const recentWritings = (await getCollection("writing"))
	.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
	.slice(0, 3);
---

<!doctype html>
<html lang='en'>
	<head>
		<BaseHead
			title={SITE_TITLE}
			description={SITE_DESCRIPTION}
			image='/images/ogimage.png'
		/>
	</head>

	<RootLayout>
		<div
			id='navbar+title'
			class='flex flex-col w-full gap-6 max-w-4xl'>
			<Header />
			<h1
				class='w-full text-start text-[min(12vw,72px)] font-medium leading-[0.9] tracking-[-2px] sm:tracking-[-4px]'>
				meet somu,
				<br />
				<span class='text-orange-500 dark:text-orange-400'>android craftsman</span>
			</h1>
			<span class='sr-only'> {description} </span>
			<div
				class={clsx(
					'w-full prose prose-lg my-3 prose-p:font-medium dark:prose-invert prose-a:underline prose-a:underline-offset-2 items-center justify-center',
					'prose-a:text-gray-700 dark:prose-a:text-gray-400 hover:prose-a:text-gray-900 dark:hover:prose-a:text-gray-100',
					'prose-h1:font-medium prose-h2:font-medium prose-h3:font-medium prose-h4:font-medium prose-h5:font-medium prose-h6:font-medium',
					'prose-h1:tracking-tight prose-h2:tracking-tight prose-h3:tracking-tight prose-h4:tracking-tight prose-h5:tracking-tight prose-h6:tracking-tight',
					'prose-h2:text-orange-500 dark:prose-h2:text-orange-400',
					'prose-ul:font-medium prose-ol:font-medium prose-li:font-medium',
					'prose-ul:space-y-2 prose-ol:space-y-3 prose-li:space-y-3'
				)}>
				<Content />
			</div>

			<!-- Recent Writings Section -->
			<div id='recent-writings' class='flex flex-col gap-6 mt-12 w-full'>
				<div class='flex items-center justify-between'>
					<h2 class='text-sm font-medium tracking-wider uppercase text-gray-500 dark:text-gray-400'>
						WRITINGS
					</h2>
					<a
						href='/rss.xml'
						class='text-sm font-medium text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 border border-gray-300 dark:border-gray-700 hover:border-gray-400 dark:hover:border-gray-600 px-3 py-1.5 rounded inline-flex items-center gap-2'>
						RSS feed
						<span class='inline-block'>↗</span>
					</a>
				</div>
				<div class='flex flex-col gap-6'>
					{
						recentWritings.map((writing) => (
							<WritingItem
								title={writing.data.title}
								date={writing.data.pubDate}
								slug={writing.slug}
							/>
						))
					}
				</div>
				<a
					href='/writings'
					class='text-base font-medium text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 inline-flex items-center gap-1'>
					View all posts
					<span class='inline-block'>→</span>
				</a>
			</div>

			<div id='social-links' class='flex flex-row gap-4 mt-6'>
				{
					socialLinks.map((link) => (
						<a
							href={link.url}
							class='text-lg font-medium text-gray-700 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:underline underline-offset-2'>
							{link.label}
						</a>
					))
				}
			</div>
		</div>
	</RootLayout>
</html>
